CREATE OR REPLACE TRIGGER update_refer_count
AFTER INSERT OR DELETE ON CUSTOMER
FOR EACH ROW
BEGIN
  UPDATE CUSTOMER SET REFER_COUNT = (SELECT COUNT(*) FROM CUSTOMER WHERE REFERER_ID = :NEW.USER_ID) WHERE USER_ID = :NEW.USER_ID;
END;
/