CREATE OR REPLACE FUNCTION PWD_HASH(input_string IN VARCHAR2)
RETURN VARCHAR2
IS
  encoded_string VARCHAR2(32767);
  hash_raw RAW(64);
  hash_output VARCHAR2(128);
BEGIN
  encoded_string := UTL_RAW.CAST_TO_VARCHAR2(UTL_ENCODE.BASE64_ENCODE(UTL_RAW.CAST_TO_RAW(input_string)));

  SELECT STANDARD_HASH(encoded_string,'SHA512') INTO hash_raw FROM DUAL;

  hash_output := RAWTOHEX(hash_raw);

  RETURN hash_output;
EXCEPTION
  WHEN OTHERS THEN
    RETURN NULL;
END;
/

CREATE OR REPLACE FUNCTION CHK_CREDS_NAME(USER_NAME IN VARCHAR2,USER_PWD IN VARCHAR2)RETURN NUMBER IS 
	CHK_PWD VARCHAR2(128);
	CHK_USER NUMBER;
BEGIN
	SELECT COUNT(USER_ID) INTO CHK_USER FROM "USER" WHERE NAME = USER_NAME AND IS_DELETED = 'F';
	
	IF CHK_USER = 0 THEN 
		RETURN -404;
	ELSE 
			SELECT PWD INTO CHK_PWD FROM "USER" WHERE NAME = USER_NAME AND IS_DELETED = 'F';
			
			IF CHK_PWD = PWD_HASH(USER_PWD) THEN 
				RETURN 1337;
			ELSE
				RETURN -404;
			END IF;
	END IF;
EXCEPTION
		WHEN NO_DATA_FOUND THEN 
			RETURN -1;
END;
/